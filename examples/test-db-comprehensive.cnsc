Story: Todo List Database Application

G: db:S="todo.db", setup_done:I=0, task_id:I=0, all_tasks:S="", completed_tasks:S="", task_name:S="Buy groceries", task_name2:S="Write code", task_name3:S="Read book"

S1→ Effect: DB CONNECT TO "todo.db" AS db

S2→ Effect: DB EXECUTE "CREATE TABLE IF NOT EXISTS tasks (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT NOT NULL, completed INTEGER DEFAULT 0, created_at TEXT DEFAULT CURRENT_TIMESTAMP)" AS db

S3→ Effect: DB EXECUTE "DELETE FROM tasks" AS db

S4→ Effect: DB EXECUTE "INSERT INTO tasks (name, completed) VALUES ('Buy groceries', 0)" AS db
S5→ Effect: DB EXECUTE "INSERT INTO tasks (name, completed) VALUES ('Write code', 0)" AS db
S6→ Effect: DB EXECUTE "INSERT INTO tasks (name, completed) VALUES ('Read book', 1)" AS db

S7→ Effect: Print "=== All Tasks ==="
S8→ Effect: DB QUERY "SELECT id, name, completed FROM tasks ORDER BY id" AS db INTO all_tasks
S9→ Effect: Print "{all_tasks}"

S10→ Effect: Print "\n=== Incomplete Tasks ==="
S11→ Effect: DB QUERY "SELECT name FROM tasks WHERE completed = 0" AS db INTO incomplete
S12→ Effect: Print "{incomplete}"

S13→ Effect: Print "\n=== Completing 'Buy groceries' ==="
S14→ Effect: DB EXECUTE "UPDATE tasks SET completed = 1 WHERE name = 'Buy groceries'" AS db

S15→ Effect: Print "\n=== Completed Tasks ==="
S16→ Effect: DB QUERY "SELECT name FROM tasks WHERE completed = 1 ORDER BY name" AS db INTO completed_tasks
S17→ Effect: Print "{completed_tasks}"

S18→ Effect: Print "\n=== Task Count ===" 
S19→ Effect: DB QUERY "SELECT COUNT(*) as total FROM tasks" AS db INTO count_result
S20→ Effect: Print "Total tasks: {count_result}"

S21→ Effect: Print "\n=== Deleting completed tasks ==="
S22→ Effect: DB EXECUTE "DELETE FROM tasks WHERE completed = 1" AS db

S23→ Effect: Print "\n=== Remaining Tasks ==="
S24→ Effect: DB QUERY "SELECT name FROM tasks" AS db INTO remaining
S25→ Effect: Print "{remaining}"

E: remaining
